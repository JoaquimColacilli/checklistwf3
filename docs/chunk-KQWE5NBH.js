import{X as R,_ as B,aa as L,ba as G,n as M,na as b,p as D,pa as q,qa as H,ra as J,sa as K,ta as Q,ua as X,va as Y,wa as Z,xa as $,ya as ee}from"./chunk-2XORILJT.js";import"./chunk-TC6LVV5X.js";import{Bb as V,Cb as A,Ia as s,Ja as N,Qb as z,_a as y,ab as h,cb as E,eb as r,ec as O,fb as n,fc as W,gb as k,ic as j,ja as T,jb as v,lb as d,mb as c,sa as m,ta as g,tb as o,ub as I,vb as f,wb as F,xb as P,yb as S,zb as U}from"./chunk-NOL2URQB.js";import{a as _,b as w,f as p}from"./chunk-XBB5NZD7.js";var te=()=>[5,10,15,20];function ie(l,u){if(l&1){let a=v();r(0,"div",17)(1,"div",18)(2,"div",19)(3,"h2",20),o(4," Nuevo Usuario "),n(),r(5,"form",21),d("ngSubmit",function(){m(a);let e=c();return g(e.guardarUsuario())}),r(6,"div",22)(7,"label",23),o(8,"Nombre"),n(),r(9,"input",24),U("ngModelChange",function(e){m(a);let i=c();return S(i.nuevoUsuario.nombre,e)||(i.nuevoUsuario.nombre=e),g(e)}),n()(),r(10,"div",22)(11,"label",25),o(12,"Apellido"),n(),r(13,"input",26),U("ngModelChange",function(e){m(a);let i=c();return S(i.nuevoUsuario.apellido,e)||(i.nuevoUsuario.apellido=e),g(e)}),n()(),r(14,"div",27)(15,"button",28),d("click",function(){m(a);let e=c();return g(e.cerrarModalNuevoUsuario())}),o(16," Cancelar "),n(),r(17,"button",29),o(18,"Guardar"),n()()()()()()}if(l&2){let a=c();s(9),P("ngModel",a.nuevoUsuario.nombre),s(4),P("ngModel",a.nuevoUsuario.apellido)}}function re(l,u){if(l&1){let a=v();r(0,"div",17)(1,"div",30)(2,"h2",31),o(3," Confirmar eliminaci\xF3n "),n(),r(4,"p",32),o(5," \xBFEst\xE1 seguro de eliminar al usuario "),r(6,"strong"),o(7),n(),r(8,"strong"),o(9),n(),o(10,"? "),n(),r(11,"div",33)(12,"button",2),d("click",function(){m(a);let e=c();return g(e.showConfirmDeleteModal=!1)}),o(13," Cancelar "),n(),r(14,"button",34),d("click",function(){m(a);let e=c();return g(e.eliminarUsuario())}),o(15,"Eliminar"),n()()()()}if(l&2){let a=c();s(7),I(a.userToDelete==null?null:a.userToDelete.nombre),s(2),f(" ",a.userToDelete==null?null:a.userToDelete.apellido,"")}}function ne(l,u){if(l&1){let a=v();r(0,"tr",35)(1,"td",36),o(2),n(),r(3,"td",36),o(4),n(),r(5,"td",36),o(6),n(),r(7,"td",36),o(8),n(),r(9,"td",36)(10,"button",37),d("click",function(){let e=m(a).index,i=c();return g(i.editarUsuario(e))}),k(11,"i",38),n(),r(12,"button",39),d("click",function(){let e=m(a).index,i=c();return g(i.confirmDeleteUser(e))}),k(13,"i",40),n()()()}if(l&2){let a=u.$implicit,t=u.index,e=c();s(2),f(" ",t+1+(e.currentPage-1)*e.itemsPerPage," "),s(2),f(" ",a.nombre," "),s(2),f(" ",a.apellido," "),s(2),f(" ",a.fechaAlta," ")}}function oe(l,u){if(l&1&&(r(0,"option",41),o(1),n()),l&2){let a=u.$implicit;h("value",a),s(),f(" ",a," ")}}var ge=(()=>{let u=class u{constructor(t){this.cdr=t,this.modalNuevoUsuarioAbierto=!1,this.showConfirmDeleteModal=!1,this.usuarios=[],this.pagedUsuarios=[],this.nuevoUsuario={nombre:"",apellido:"",fechaAlta:""},this.usuarioSeleccionado=null,this.userToDelete=null,this.itemsPerPage=5,this.currentPage=1,this.totalPages=1}ngOnInit(){return p(this,null,function*(){yield this.cargarUsuarios()})}cargarUsuarios(){return p(this,null,function*(){let t=M(b,"usuarios"),e=yield R(t);this.usuarios=e.docs.map(i=>_({id:i.id},i.data())),this.totalPages=Math.ceil(this.usuarios.length/this.itemsPerPage),this.actualizarPagina(),this.cdr.markForCheck()})}actualizarPagina(){let t=(this.currentPage-1)*this.itemsPerPage,e=t+this.itemsPerPage;this.pagedUsuarios=this.usuarios.slice(t,e)}cambiarItemsPorPagina(){this.totalPages=Math.ceil(this.usuarios.length/this.itemsPerPage),this.currentPage=1,this.actualizarPagina()}paginaAnterior(){this.currentPage>1&&(this.currentPage--,this.actualizarPagina())}paginaSiguiente(){this.currentPage<this.totalPages&&(this.currentPage++,this.actualizarPagina())}abrirNuevoUsuarioModal(){this.modalNuevoUsuarioAbierto=!0,this.usuarioSeleccionado=null,this.nuevoUsuario={nombre:"",apellido:"",fechaAlta:""}}cerrarModalNuevoUsuario(){this.modalNuevoUsuarioAbierto=!1}guardarUsuario(){return p(this,null,function*(){this.usuarioSeleccionado?(this.nuevoUsuario.fechaAlta=new Date().toISOString().split("T")[0],yield this.actualizarUsuario()):(this.nuevoUsuario.fechaAlta=new Date().toISOString().split("T")[0],yield this.agregarNuevoUsuario()),this.cerrarModalNuevoUsuario()})}agregarNuevoUsuario(){return p(this,null,function*(){try{let t=M(b,"usuarios"),e=yield G(t,this.nuevoUsuario);this.usuarios.push(w(_({},this.nuevoUsuario),{id:e.id})),this.totalPages=Math.ceil(this.usuarios.length/this.itemsPerPage),this.actualizarPagina(),this.cdr.markForCheck()}catch(t){console.error("Error guardando el nuevo usuario en Firestore:",t)}})}actualizarUsuario(){return p(this,null,function*(){if(this.usuarioSeleccionado)try{let t=D(b,"usuarios",this.usuarioSeleccionado.id);yield B(t,_({},this.nuevoUsuario));let e=this.usuarios.findIndex(i=>i.id===this.usuarioSeleccionado.id);e>-1&&(this.usuarios[e]=w(_({},this.nuevoUsuario),{id:this.usuarioSeleccionado.id})),this.actualizarPagina(),this.cdr.markForCheck()}catch(t){console.error("Error actualizando el usuario en Firestore:",t)}})}editarUsuario(t){let e=(this.currentPage-1)*this.itemsPerPage;this.usuarioSeleccionado=this.usuarios[e+t],this.nuevoUsuario=_({},this.usuarioSeleccionado),this.modalNuevoUsuarioAbierto=!0}confirmDeleteUser(t){let e=(this.currentPage-1)*this.itemsPerPage;this.userToDelete=this.usuarios[e+t],this.showConfirmDeleteModal=!0}eliminarUsuario(){return p(this,null,function*(){if(this.userToDelete)try{let t=this.userToDelete.id,e=D(b,"usuarios",t);yield L(e),this.usuarios=this.usuarios.filter(i=>i.id!==t),this.totalPages=Math.ceil(this.usuarios.length/this.itemsPerPage),this.actualizarPagina(),this.showConfirmDeleteModal=!1,this.cdr.markForCheck()}catch(t){console.error("Error eliminando el usuario en Firestore:",t)}})}};u.\u0275fac=function(e){return new(e||u)(N(z))},u.\u0275cmp=T({type:u,selectors:[["app-usuarios"]],standalone:!0,features:[V],decls:36,vars:14,consts:[[1,"font-bold","text-lg","lg:text-3xl","mb-4"],[1,"flex","justify-end","mb-4"],[1,"btn-primary","mr-2",3,"click"],["class","fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50",4,"ngIf"],[1,"overflow-x-auto","mt-4"],[1,"w-full","table-auto","bg-gray-800","rounded-lg","overflow-hidden"],[1,"bg-gray-700","text-white"],[1,"px-4","py-2"],["class","hover:bg-gray-700 transition-colors",4,"ngFor","ngForOf"],[1,"flex","justify-between","items-center","mt-4","px-4","py-2","bg-gray-900","rounded-md"],[1,"flex","items-center"],["for","itemsPerPage",1,"text-gray-300","mr-2"],["id","itemsPerPage",1,"rounded-md","text-gray-900","bg-gray-200","border","border-gray-400","focus:outline-none","focus:ring-2","focus:ring-indigo-600",3,"ngModelChange","change","ngModel"],[3,"value",4,"ngFor","ngForOf"],[1,"flex","items-center","space-x-2"],[1,"btn-secondary",3,"click","disabled"],[1,"text-gray-300"],[1,"fixed","inset-0","flex","items-center","justify-center","bg-black","bg-opacity-50","z-50"],[1,"bg-gray-900","rounded-lg","w-1/4","max-h-[80%]","max-w-[80%]","overflow-auto","px-3","py-2","scrollbar-thin","scrollbar-thumb-gray-700","scrollbar-track-gray-900","scrollbar-thumb-rounded-full","scrollbar-track-rounded-full"],[1,"modal-content"],[1,"text-2xl","font-bold","text-center","text-white","mb-4"],[3,"ngSubmit"],[1,"mb-4"],["for","nombre",1,"block","text-gray-300","mb-1"],["id","nombre","name","nombre",1,"w-full","rounded-md","text-gray-900","bg-gray-200","border","border-gray-400","focus:outline-none","focus:ring-2","focus:ring-indigo-600",3,"ngModelChange","ngModel"],["for","apellido",1,"block","text-gray-300","mb-1"],["id","apellido","name","apellido",1,"w-full","rounded-md","text-gray-900","bg-gray-200","border","border-gray-400","focus:outline-none","focus:ring-2","focus:ring-indigo-600",3,"ngModelChange","ngModel"],[1,"flex","justify-end","mt-4"],["type","button",1,"btn-primary","mr-1",3,"click"],["type","submit",1,"btn-primary"],[1,"bg-gray-900","rounded-lg","p-4","max-w-sm"],[1,"text-lg","font-bold","text-center","text-white","mb-3"],[1,"text-gray-300","mb-4","text-center","justify-center"],[1,"flex","justify-end"],[1,"btn-primary",3,"click"],[1,"hover:bg-gray-700","transition-colors"],[1,"px-4","py-2","border-b","border-gray-700","text-center"],[1,"btn-secondary","transition-transform","duration-300","ease-in-out","hover:scale-105","mr-2",3,"click"],[1,"fas","fa-edit"],[1,"btn-secondary","transition-transform","duration-300","ease-in-out","hover:scale-105",3,"click"],[1,"fas","fa-trash"],[3,"value"]],template:function(e,i){e&1&&(r(0,"h1",0),o(1,"Usuarios"),n(),r(2,"div",1)(3,"button",2),d("click",function(){return i.abrirNuevoUsuarioModal()}),o(4," Nuevo Usuario "),n()(),y(5,ie,19,2,"div",3)(6,re,16,2,"div",3),r(7,"div",4)(8,"table",5)(9,"thead")(10,"tr",6)(11,"th",7),o(12,"ID"),n(),r(13,"th",7),o(14,"Nombre"),n(),r(15,"th",7),o(16,"Apellido"),n(),r(17,"th",7),o(18,"Fecha de Alta"),n(),r(19,"th",7),o(20,"Acciones"),n()()(),r(21,"tbody"),y(22,ne,14,4,"tr",8),n()()(),r(23,"div",9)(24,"div",10)(25,"label",11),o(26,"Items por p\xE1gina:"),n(),r(27,"select",12),U("ngModelChange",function(C){return S(i.itemsPerPage,C)||(i.itemsPerPage=C),C}),d("change",function(){return i.cambiarItemsPorPagina()}),y(28,oe,2,2,"option",13),n()(),r(29,"div",14)(30,"button",15),d("click",function(){return i.paginaAnterior()}),o(31," Anterior "),n(),r(32,"span",16),o(33),n(),r(34,"button",15),d("click",function(){return i.paginaSiguiente()}),o(35," Siguiente "),n()()()),e&2&&(s(5),h("ngIf",i.modalNuevoUsuarioAbierto),s(),h("ngIf",i.showConfirmDeleteModal),s(16),h("ngForOf",i.pagedUsuarios),s(5),P("ngModel",i.itemsPerPage),s(),h("ngForOf",A(13,te)),s(2),E("opacity-50",i.currentPage===1),h("disabled",i.currentPage===1),s(3),F("P\xE1gina ",i.currentPage," de ",i.totalPages,""),s(),E("opacity-50",i.currentPage===i.totalPages),h("disabled",i.currentPage===i.totalPages))},dependencies:[j,O,W,ee,X,Z,$,q,Y,H,J,Q,K],encapsulation:2,changeDetection:0});let l=u;return l})();export{ge as default};
